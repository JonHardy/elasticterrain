<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no, width=device-width">
    <link rel="stylesheet" href="../../www/src/resources/css/ol.css" type="text/css">
    <link rel="stylesheet" href="../../www/src/resources/css/jquery-ui.min.css" />
    <link rel="stylesheet" href="../../www/src/resources/css/base.css" type="text/css" />
    <link rel="stylesheet" href="../../www/src/resources/css/controlbar.css" type="text/css" />
    <link rel="stylesheet" href="../../www/src/resources/css/showcase.css" type="text/css" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,600' rel='stylesheet' type='text/css' />
    <link rel="stylesheet" href="../../www/src/resources/font-awesome/css/font-awesome.min.css">
    <script src="../../www/src/resources/js/jquery-2.1.3.min.js"></script>
    <script src="../../www/src/resources/js/jquery-ui.min.js"></script>
    <script src="../../www/src/resources/js/jquery_knob.js"></script>
    <title>Elastic Terrain Map</title>
</head>

<body>
    <div class="container">
        <div class="controlBar">
            <a href="https://github.com/buddebej/elasticterrain"><img style="position: absolute; width: 90px; height: 90px; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/a6677b08c955af8400f44c6298f40e7d19cc5b2d/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f677261795f3664366436642e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png"></a>
            <div class="control info">
                <div class="infoBox">
                    <img src="../../www/src/resources/images/elasticterrain_logo.svg" width="174px"></img>
                    <br>Jonas Buddeberg, Bernhard Jenny
                    <div class="menue">
                        <div id="minfo" class="item">What is this?</div>
                        <div id="mdata" class="item">Data</div>
                        <div id="mproblems" class="item">Problems</div>
                        <div id="mabout" class="item">About</div>
                    </div>
                    <div class="content">
                        <div class="minfo topborder">
                            Elastic Terrain is a new method for terrain visualization that uses animation.
                            <br>The Elastic Terrain Map is based on <a href="http://openlayers.org/" target="_blank">OpenLayers</a>.
                        </div>
                        <div class="mdata topborder">
                            <p><a href="http://fbinter.stadt-berlin.de/fb/berlin/service.jsp?id=a_dgm2@senstadt&type=FEED" target="_blank">Geoportal Berlin / ATKIS DGM2</a></p>
                            <p><a href="http://www.eea.europa.eu/data-and-maps/data/eu-dem" target="_blank">EUDEM<br>Produced using Copernicus data and information funded by the European Union</a></p>
                            <p><a href="http://www.gebco.net" target="_blank">The GEBCO Digital Atlas<br> published by the British Oceanographic Data Centre on behalf of IOC and IHO 2003</a></p>
                            <p><a href="http://research.bpcrc.osu.edu/GDG/gimpdem.php" target="_blank">Greenland Mapping Project (GIMP)<br> Digital Elevation Model by BPRC Glacier Dynamics Research Group, Ohio State University</a></p>
                            <p><a href="https://lta.cr.usgs.gov/SRTM1Arc" target="_blank">NASA's Shuttle Radar Topography Mission<br>1 arc-second</a></p>
                            <p><a href="https://lta.cr.usgs.gov/SRTM1Arc" target="_blank">NASA's Shuttle Radar Topography Mission<br>3 arc-seconds</a></p>
                            <p><a href="http://www.wien.gv.at/stadtentwicklung/stadtvermessung/geodaten/dgm/produkt.html" target="_blank">Digital surface model of Vienna â€“ data.wien.gv.at</a></p>
                        </div>
                        <div class="mabout topborder">
                            <p>The Elastic Terrain Map software is licensed under <a href="https://github.com/buddebej/elasticterrain/blob/master/LICENSE.md" target="_blank">GPL v3</a>. The source code is available on <a href="https://github.com/buddebej/elasticterrain" target="_blank">Github</a>. <a href="https://github.com/buddebej/elasticterrain" target="_blank">Feel free to fork our repository.</a></p>
                            <div class="logoContainer">
                                <a href="http://cartography.oregonstate.edu/" target="_blank" title="Cartography and Geovisualization Group at Oregon State University">
                                    <img src="../../www/src/resources/images/cartogroup_logo.svg"></img>
                                </a>
                            </div>
                        </div>
                        <div class="mproblems topborder">
                            <p>This application is optimized for an up-to-date version of Google Chrome, Chromium or Firefox. 3D animations may be slow or laggy on older devices. You can try to reduce your browser window.
                                <br>
                                <br>Please report bugs on github.</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="control inclination">
                <div class="controlHeader">
                    <div><i class="fa fa-area-chart fa-fw"></i>&nbsp; Plan Oblique Relief</div>
                </div>
                <div class="controlBody">
                    <p class="knobLabel">Inclination</p>
                    <div class="knob">
                        <input type="text" class="inclinationKnob" data-cursor="true">
                    </div>
                </div>
            </div>
            <div class="control texture">
                <div class="controlHeader">
                    <div><i class="fa fa-picture-o fa-fw"></i>&nbsp; Map</div>
                </div>
                <div class="controlBody">
                    <select class="textureSelect"></select>
                    <!--   <div class="switchBox floatLeft">
                        <div class="onoffswitch">
                            <input type="checkbox" name="onoffswitch" class="onoffswitch-checkbox dynamicColorsSwitch" id="switchDynamicColors">
                            <label class="onoffswitch-label" for="switchDynamicColors">
                                <span class="onoffswitch-inner"></span>
                                <span class="onoffswitch-switch"></span>
                            </label>
                        </div>
                        <span class="checkboxLabel">Hybrid.</span>
                    </div>
                    <div class="clearFloat"></div> -->
                    <div class="colorControls">
                        <select class="colorRampSelect">
                            <option value="0">ColorRamp 1</option>
                            <option value="1">ColorRamp 2</option>
                        </select>
                        <div class="switchBox">
                            <div class="onoffswitch">
                                <input type="checkbox" name="onoffswitch" class="onoffswitch-checkbox dynamicColorsSwitch" id="switchDynamicColors">
                                <label class="onoffswitch-label" for="switchDynamicColors">
                                    <span class="onoffswitch-inner"></span>
                                    <span class="onoffswitch-switch"></span>
                                </label>
                            </div>
                            <span class="checkboxLabel">Dynamic Colors</span>
                        </div>
                        <div class="vcenter staticColorsScale">
                            Static Colors
                            <div class="colorSlider floatingSlider"></div>
                        </div>
                        <div class="switchBox">
                            <div class="onoffswitch">
                                <input type="checkbox" name="onoffswitch" class="onoffswitch-checkbox waterBodiesSwitch" id="switchWaterbodies">
                                <label class="onoffswitch-label" for="switchWaterbodies">
                                    <span class="onoffswitch-inner"></span>
                                    <span class="onoffswitch-switch"></span>
                                </label>
                            </div>
                            <span class="checkboxLabel">Detect Inland Water Bodies</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="control shading">
                <div class="controlHeader">
                    <div class="onoffswitch">
                        <input type="checkbox" name="onoffswitch" class="ows onoffswitch-checkbox shadingSwitch" id="switchShading">
                        <label class="ows onoffswitch-label" for="switchShading">
                            <span class="ows onoffswitch-inner"></span>
                            <span class="ows onoffswitch-switch"></span>
                        </label>
                    </div>
                    <div class="switchlabel"><i class="fa fa-paint-brush fa-fw"></i>&nbsp; Shading</div>
                </div>
                <div class="controlBody">
                    <div class="floatBox">
                        <p class="knobLabel">Zenith</p>
                        <div class="knob">
                            <input type="text" class="lightZenithKnob" data-cursor="true"></input>
                        </div>
                    </div>
                    <div class="floatBox">
                        <p class="knobLabel">Azimuth</p>
                        <div class="knob">
                            <input type="text" class="lightAzimuthKnob" data-cursor="true"></input>
                        </div>
                    </div>
                    <div class="clearFloat"></div>
                    <div class="vcenter">
                        Ambient Light
                        <div class="ambientLightSlider floatingSlider"></div>
                    </div>
                    <div class="vcenter">
                        Darkness
                        <div class="darknessSlider floatingSlider"></div>
                    </div>
                    <div class="vcenter">
                        Vertical Exaggeration
                        <div class="exaggerationSlider floatingSlider"></div>
                    </div>
                    <div class="switchBox">
                        <div class="onoffswitch">
                            <input type="checkbox" name="onoffswitch" class="onoffswitch-checkbox stackedCardboardSwitch" id="switchStackedCardboard">
                            <label class="onoffswitch-label" for="switchStackedCardboard">
                                <span class="onoffswitch-inner"></span>
                                <span class="onoffswitch-switch"></span>
                            </label>
                        </div>
                        <span class="checkboxLabel">Ocean Floor Contours</span>
                    </div>
                </div>
            </div>
            <div class="control shearing">
                <div class="controlHeader">
                    <div class="onoffswitch">
                        <input type="checkbox" name="onoffswitch" class="ows onoffswitch-checkbox shearingInteractionsSwitch" id="switchInteraction">
                        <label class="ows onoffswitch-label" for="switchInteraction">
                            <span class="ows onoffswitch-inner"></span>
                            <span class="ows onoffswitch-switch"></span>
                        </label>
                    </div>
                    <div class="switchlabel"><i class="fa fa-lightbulb-o fa-fw"></i>&nbsp; Elastic Terrain</div>
                </div>
                <div class="controlBody">
                    <div class="vcenter">
                        Spring Coefficient
                        <div class="springCoefficientSlider floatingSlider"></div>
                    </div>
                    <div class="vcenter">
                        Friction Force
                        <div class="springFrictionSlider floatingSlider"></div>
                    </div>
                    <div class="vcenter">
                        Sticky Shearing
                        <div class="springInnerRadiusSlider floatingSlider"></div>
                    </div>
                    <div class="vcenter">
                        Sticky Panning
                        <div class="springOuterRadiusSlider floatingSlider"></div>
                    </div>
                    <div class="vcenter">
                        Explicit Shearing Fadeout
                        <div class="springFadeoutSlider floatingSlider"></div>
                    </div>
                    <div class="vcenter">
                        Explicit to Hybrid Damping
                        <div class="springHybridDamping floatingSlider"></div>
                    </div>
                </div>
            </div>
            <div class="control debug">
                <div class="controlHeader">
                    <div><i class="fa fa fa-wrench fa-fw"></i>&nbsp; Testing</div>
                </div>
                <div class="controlBody">
                    <div class="switchBox">
                        <div class="onoffswitch">
                            <input type="checkbox" name="onoffswitch" class="onoffswitch-checkbox debugModeSwitch" id="switchDebug">
                            <label class="onoffswitch-label" for="switchDebug">
                                <span class="onoffswitch-inner"></span>
                                <span class="onoffswitch-switch"></span>
                            </label>
                        </div>
                        <span class="checkboxLabel">Debug mode</span>
                    </div>
                    <div class="switchBox">
                        <div class="onoffswitch">
                            <input type="checkbox" name="onoffswitch" class="onoffswitch-checkbox wireframeModeSwitch" id="switchWireframe">
                            <label class="onoffswitch-label" for="switchWireframe">
                                <span class="onoffswitch-inner"></span>
                                <span class="onoffswitch-switch"></span>
                            </label>
                        </div>
                        <span class="checkboxLabel">Draw Wireframes</span>
                    </div>
                    <div class="vcenter">
                        Model Resolution
                        <div class="resolutionSlider floatingSlider"></div>
                    </div>
                    <div class="vcenter">
                        <div id="no-download" class="alert alert-error" style="display: none">
                            The export feature is not supported by your browser.
                        </div>
                        Export Map (instable)<a id="export-png" class="controlbutton floatingSlider" download="map.png">Download PNG Image</a>
                    </div>
                </div>
            </div>
            <div class="control rotation">
                <div class="controlHeader ">
                    <div><i class="fa fa-repeat fa-fw"></i>&nbsp; Map Rotation</div>
                </div>
                <div class="controlBody">
                    <div class="floatLeft">
                        <p class="knobLabel">0Â° is North</p>
                        <div class="knob">
                            <input type="text" class="rotationKnob" data-cursor="true">
                        </div>
                    </div>
                    <div class="floatLeft knobLabel" style="margin-left:2em;">
                        Or press Alt+Shift and
                        <br>drag the map to rotate it.
                    </div>
                    <div class="clearFloat"></div>
                </div>
            </div>
            <div class="control config">
                <div class="controlHeader">
                    <div><i class="fa fa-sliders fa-fw"></i>&nbsp; Load Predefined Settings</div>
                </div>
                <div class="controlBody">
                    <select class="configSelect"></select>
                </div>
            </div>
            <div class="control saveConfig">
                <div class="controlHeader">
                    <div><i class="fa fa-floppy-o fa-fw"></i>&nbsp; Save Predefined Settings</div>
                </div>
                <div class="controlBody">
                    <input type="text" name="title" class="configTitleText" placeholder="Shorttitle">
                    <div class="switchBox">
                        <div class="onoffswitch">
                            <input type="checkbox" name="onoffswitch" class="onoffswitch-checkbox saveLimitZoomlevelSwitch" id="switchSaveLimitZoomlevel">
                            <label class="onoffswitch-label" for="switchSaveLimitZoomlevel">
                                <span class="onoffswitch-inner"></span>
                                <span class="onoffswitch-switch"></span>
                            </label>
                        </div>
                        <span class="checkboxLabel">Limit to current zoomlevel</span>
                    </div>
                    <div class="switchBox">
                        <div class="onoffswitch">
                            <input type="checkbox" name="onoffswitch" class="onoffswitch-checkbox saveLimitExtentSwitch" id="switchSaveLimitExtent">
                            <label class="onoffswitch-label" for="switchSaveLimitExtent">
                                <span class="onoffswitch-inner"></span>
                                <span class="onoffswitch-switch"></span>
                            </label>
                        </div>
                        <span class="checkboxLabel">Limit to current extent</span>
                    </div>
                    <div class="switchBox">
                        <div class="onoffswitch">
                            <input type="checkbox" name="onoffswitch" class="onoffswitch-checkbox saveLimitRotationSwitch" id="switchSaveLimitRotation">
                            <label class="onoffswitch-label" for="switchSaveLimitRotation">
                                <span class="onoffswitch-inner"></span>
                                <span class="onoffswitch-switch"></span>
                            </label>
                        </div>
                        <span class="checkboxLabel">Disable Rotation</span>
                    </div>
                    <a class="controlbutton saveconfig floatLeft">Save Config</a>
                    <a class="controlbutton editconfig floatLeft">Edit Config</a>
                    <div class="clearFloat"></div>
                </div>
            </div>
        </div>
        <div id="map" class="map"></div>
    </div>
</body>
<script src="loader.js?id=elasticterrain" type="text/javascript"></script>
<script src="../../www/src/js/webglcheck.js" type="text/javascript"></script>
<script src="../../www/src/js/layers.js" type="text/javascript"></script>
<script src="../../www/src/js/viewer.js" type="text/javascript"></script>
<script src="../../www/src/js/controlbar.js" type="text/javascript"></script>
<script src="../../www/src/js/configmanager_static.js" type="text/javascript"></script>
<script src="../../www/src/js/showcase.js" type="text/javascript"></script>
<script>
    

$(document).ready(function() {
    'use strict';

var Config = function() {
    'use strict';

    // static config
    this.defaultZoomLevelRange = [2, 4];
    this.defaultMapExtent = [];
    // dynamic config 
    // can be saved and loaded by configManager
    // can be modified by controlBar
    // initial values
    this.init = {
        // shading
        shading: true, // bool
        shadingDarkness: 0.1, // 0:1
        shadingExaggeration: 0.3, // 0:1         
        lightAzimuth: 315, // 0:360
        lightZenith: 45, // 0:90
        ambientLight: 0.1, // 0:1

        // texture
        texture: 'hypso', // see layers.js

        // hypsometric colors
        stackedCardboard: true, // bool
        waterBodies: true, // bool
        dynamicColors: true, // bool
        colorScale: [-11000, 9000], // min:max [m]  
        colorRamp: 1, // id   

        // debug         
        resolution: 0, // 0.1; 0 means automatic detection
        debug: false, // bool       
        wireframe: false, // bool       

        // view
        viewRotation: 0, // 0:360
        viewRotationEnabled: true, // 0:360

        viewCenter: [17, 37], // center of map in latlon 
        // potsdam 13.04,52.40
        // sicily 17,37
        // vienna 16.4,48.22
        // portland -122.8, 45.7     
        viewCenterConstraint: this.defaultMapExtent, // [] | [minx, miny, maxx, maxy]
        //[0, 2504688.542848654, 5009377.085697311, 7514065.628545965]
        // vienna [1790460.950551968, 6124746.202434603, 1868732.4675159885, 6203017.719398623]
        // berlin [1428455.184593372, 6848757.734351791, 1584998.218521413, 7005300.768279833]

        viewZoom: 4, // zoomlevel
        viewZoomConstraint: this.defaultZoomLevelRange, // [minZoom, maxZoom]

        // static plan oblique
        obliqueInclination: 90.0, // 0:90

        // shearingInteraction 
        terrainInteraction: true,
        shearingThreshold: 0.444,
        springCoefficient: 4,
        frictionForce: 0.2,
        maxTerrainDistortion: 20.0,
        dragDistanceBeforePan: 20.0,
        explicitFadeOutAnimationSpeed: 1.54,
        hybridTransitionDampingDuration: 0.3
    };

    this.dynamic = this.init;

    // minMax values for slider controls
    this.sliderConstraints = {
        ambientLight: [-0.5, 0.5],
        shadingDarkness: [0.0, 1.0],
        shadingExaggeration: [0.0, 1.5],
        springCoefficient: [0.0, 24],
        frictionForce: [0.0, 0.5],
        maxTerrainDistortion: [0.0, 120.0],
        dragDistanceBeforePan: [0.0, 120.0],
        explicitFadeOutAnimationSpeed: [0.1, 2.0],
        hybridTransitionDampingDuration: [0.1, 0.5],
        resolution: [0.1, 0.45]
    };


    this.set = function(attr, val) {
        this.dynamic[attr] = val;
    };

    this.get = function(attr) {
        if (attr !== undefined) {
            // return single attribute
            if (!this.dynamic.hasOwnProperty(attr)) {
                // use default value 
                return this.init[attr];
            } else {
                return this.dynamic[attr];
            }

        } else {
            // return entire config
            return this.dynamic;
        }
    };

    this.getConstraints = function(attr) {
        if (attr !== undefined) {
            if (this.sliderConstraints.hasOwnProperty(attr)) {
                return this.sliderConstraints[attr];
            } else {
                return [0.0, 1.0];
            }
        }
    };

    this.swap = function(newConfig) {
        this.dynamic = newConfig;
    };
};



    if (webgl_detect()) {

        var viewer, controlBar, config, layers, configManager;

        config = new Config();
        layers = new Layers();
        viewer = new Viewer(config, layers, $('#map'));
        
        controlBar = new ControlBar(viewer);
        configManager = new ConfigManagerStatic(viewer, controlBar);

    } else {
        $('body').append('<div class="webglMissing"><p><img src="resources/images/elasticterrain_logo.svg" width="174px"></img><br><span class="title">WebGL Not Supported</span><br> WebGL is required for this application, and your Web browser does not support WebGL. Google Chrome or Firefox are recommended browsers with WebGL support. Click <a href="http://www.browserleaks.com/webgl" target="_blank">here</a> to check the WebGL specifications of your browser.</p></div>');
    }
});


</script>

</html>



